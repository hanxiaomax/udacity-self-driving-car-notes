(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{119:function(t,a,s){t.exports=s.p+"assets/img/15401347728831.8272337e.jpg"},120:function(t,a,s){t.exports=s.p+"assets/img/15401333406014.a50f748c.jpg"},121:function(t,a,s){t.exports=s.p+"assets/img/15401323707395.6fea8125.jpg"},122:function(t,a,s){t.exports=s.p+"assets/img/15401319344883.00b2f007.jpg"},123:function(t,a,s){t.exports=s.p+"assets/img/15399574409127.8012fea9.jpg"},124:function(t,a,s){t.exports=s.p+"assets/img/15399561190760.62f938c1.jpg"},125:function(t,a,s){t.exports=s.p+"assets/img/15399554841338.52a159fb.jpg"},359:function(t,a,s){"use strict";s.r(a);var n=[function(){var t=this,a=t.$createElement,n=t._self._c||a;return n("div",{staticClass:"content"},[n("h1",{attrs:{id:"卡尔曼滤波"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#卡尔曼滤波","aria-hidden":"true"}},[t._v("#")]),t._v(" 卡尔曼滤波")]),n("h2",{attrs:{id:"_1-更新循环和移动循环"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-更新循环和移动循环","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 更新循环和移动循环")]),n("ul",[n("li",[t._v("更新循环\n基于乘法法则和贝叶斯定律")]),n("li",[t._v("移动循环（预测）\n基于卷积和全概率公式")])]),n("p",[n("img",{attrs:{src:s(125),alt:""}})]),n("h2",{attrs:{id:"_2-测量更新"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-测量更新","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 测量更新")]),n("h3",{attrs:{id:"数学原理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数学原理","aria-hidden":"true"}},[t._v("#")]),t._v(" 数学原理")]),n("p",[t._v("测量的更新，基于乘法法则和贝叶斯定律。\n首先我们有一个先验的测量值，然后得到一个新的测量值，两者均为正态分布。使用贝叶斯定律，我们可以得到后验概率，也就是我们更新测量后的结果")]),n("p",[n("img",{attrs:{src:s(124),alt:""}})]),n("p",[t._v("P(X|Z) = P(Z|X)P(X)/P(Z)\n叠加之后的正态分布参数为\n$\n\\mu^2=\\frac{\\mu* r^2 + \\gamma*\\sigma^2}{r^2+\\sigma^2}\n$")]),n("p",[t._v("$\n\\sigma^2=\\frac{1}{\\frac{1}{r^2}+\\frac{1}{\\sigma^2}}\n$")]),n("h3",{attrs:{id:"代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码","aria-hidden":"true"}},[t._v("#")]),t._v(" 代码")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("update")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mean1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mean2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    new_mean "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mean1"),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("var2"),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("mean2"),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("var1"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token operator"}},[t._v("/")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("var1"),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    new_var "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token operator"}},[t._v("/")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("var1 "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("new_mean"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" new_var"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),n("h2",{attrs:{id:"_3-移动更新（预测过程）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-移动更新（预测过程）","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 移动更新（预测过程）")]),n("p",[n("img",{attrs:{src:s(123),alt:""}}),t._v("\n预测过程基于卷积和全概率公式")]),n("h3",{attrs:{id:"数学原理-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数学原理-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 数学原理")]),n("p",[t._v("假设我们处于一个初始位置，然后进行一次移动，移动本身是有误差的，两个事件都服从正态分布。则结果也是正态分布")]),n("p",[t._v("$\n\\mu'=\\mu + u\n$")]),n("p",[t._v("$\n\\sigma'^2 =r^2+\\sigma^2\n$")]),n("h3",{attrs:{id:"代码-2"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#代码-2","aria-hidden":"true"}},[t._v("#")]),t._v(" 代码")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("predict")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mean1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mean2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    new_mean "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mean1"),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("mean2\n    new_var "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" var1"),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("var2\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("new_mean"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" new_var"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),n("h2",{attrs:{id:"_4-一维卡尔曼滤波代码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-一维卡尔曼滤波代码","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 一维卡尔曼滤波代码")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("# 更新函数")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("update")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mean1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mean2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    new_mean "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("float")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("var2 "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" mean1 "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" var1 "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" mean2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("var1 "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    new_var "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token operator"}},[t._v("/")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("var1 "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("new_mean"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" new_var"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# 预测函数")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("predict")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mean1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mean2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" var2"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    new_mean "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" mean1 "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" mean2\n    new_var "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" var1 "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" var2\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("new_mean"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" new_var"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nmeasurements "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("5")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("6")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("7")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("9")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("10")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# 测量值")]),t._v("\nmotion "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# 移动距离")]),t._v("\nmeasurement_sig "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("4")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# 测量方差")]),t._v("\nmotion_sig "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("2")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# 移动方差")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# 初始值")]),t._v("\nmu "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nsig "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("10000")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("range")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token builtin"}},[t._v("len")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("measurements"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mu"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sig"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("update"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mu"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sig"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("measurements"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("measurement_sig"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("print")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"update:"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mu"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sig"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("# 使用更新的均值和方差进行预测")]),t._v("\n    "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mu"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sig"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("predict"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mu"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sig"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("motion"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("motion_sig"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("print")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"pridict:"')]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mu"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("sig"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n"),n("span",{attrs:{class:"token keyword"}},[t._v("print")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mu"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" sig"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n")])]),n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("('update:', [4.998000799680128, 3.9984006397441023])\n('pridict:', [5.998000799680128, 5.998400639744102])\n('update:', [5.999200191953932, 2.399744061425258])\n('pridict:', [6.999200191953932, 4.399744061425258])\n('update:', [6.999619127420922, 2.0951800575117594])\n('pridict:', [8.999619127420921, 4.09518005751176])\n('update:', [8.999811802788143, 2.0235152416216957])\n('pridict:', [9.999811802788143, 4.023515241621696])\n('update:', [9.999906177177365, 2.0058615808441944])\n('pridict:', [10.999906177177365, 4.005861580844194])\n[10.999906177177365, 4.005861580844194]\n")])]),n("h2",{attrs:{id:"_5-多维高斯分布"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-多维高斯分布","aria-hidden":"true"}},[t._v("#")]),t._v(" 5. 多维高斯分布")]),n("p",[t._v("在多维高斯函数中，均值变成了一个向量，方差变成了协方差矩阵。其概率密度如下：\n"),n("img",{attrs:{src:s(122),alt:""}})]),n("p",[t._v("针对二维高斯分布，协方差矩阵的对角线元素为X1与X2轴的方差，反斜对角线上的两个值为协方差，表明X1与X2的线性相关程度，（正值时：X1增大，X2也随之增大；负值时：X1增大，X2随之减小）。")]),n("ul",[n("li",[t._v("如果两个变量无关，则协方差矩阵为一个圆")]),n("li",[t._v("不确定越大，圆越大")]),n("li",[t._v("也可能在一个方向上不确定大，另一个方向不确定小，则为椭圆")]),n("li",[t._v("如果两个维度相关，则椭圆为斜的，所谓相关，指的是我们可以以一个维度推断另一个维度。通过(X0 ,Y0)，则可以推断(X1 ,Y1)")])]),n("p",[n("img",{attrs:{src:s(121),alt:""}})]),n("h2",{attrs:{id:"_6-基于多维高斯函数的预测"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-基于多维高斯函数的预测","aria-hidden":"true"}},[t._v("#")]),t._v(" 6. 基于多维高斯函数的预测")]),n("p",[t._v("在平面上，基于一维的高斯，我们可以预测位置，同样的，在二维的空间中，我们也可以进行预测。")]),n("p",[n("img",{attrs:{src:s(120),alt:""}})]),n("p",[t._v("我们可以测量X，不能测量速度，但是速度是位置的导数，所以我们说两个维度是有相关性的。在测量过程中，我们可以测得X，此时我们对速度一无所知。在预测过程中，我们可以假设一个速度，这样就能知道X在此速度下，T+1时的位置X。")]),n("p",[n("img",{attrs:{src:s(119),alt:""}})]),n("p",[n("strong",[t._v("上图诠释了卡尔曼滤波的核心概念。")])]),n("p",[t._v("首先我们知道了X和速度V（X导数）的关系，X = Vt，也就是红色的椭圆。但是显然，斜椭圆表示两者是相关的。但是如果我们将红色椭圆投影到X或X点方向上，我们都无法进行预测，因为不论投影在哪个轴，我们都缺少另一个变量的信息。即单次观察和单次预测都无法确定观察结果。")]),n("p",[t._v("由于红色是我们已知的规律，所以它是一种"),n("strong",[t._v("先验概率（prior）")]),t._v("，如果我们再对X进行一次观察，得到X的"),n("strong",[t._v("条件概率(measurement)")]),t._v("，然后依据"),n("a",{attrs:{href:"https://baike.baidu.com/item/%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%85%AC%E5%BC%8F",target:"_blank",rel:"noopener noreferrer"}},[t._v("贝叶斯定律")]),t._v("将两者相乘，我们就可以得到"),n("strong",[t._v("后验概率（预测）")]),t._v("，后验概率一定相交于在红色椭圆上，它也是一个椭圆（二维高斯），且在两个维度上可以鸽子得到一个高斯函数，预测相关维度。经过不断的测量和预测，我们注意到，红色椭圆上的黑色椭圆越来越小，表示不确定性逐渐减小（方差减小了）")]),n("p",[t._v("这深刻的揭示了卡尔曼滤波器的原理，我们只能观察一个值的时候，就可以利用贝叶斯推断另外一个值（通过先验知识——例如物理方程）")]),n("p",[t._v("卡尔曼滤波器可以预测一段时间后我的位置，"),n("code",[t._v("x' = x + Δtẋ'")]),t._v("，且该方程在后续的预测中可以作为约束条件。利用该约束条件，我们就可以通过x来预测速度（本身不能观察）")]),n("h2",{attrs:{id:"_7-设计卡尔曼滤波器"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-设计卡尔曼滤波器","aria-hidden":"true"}},[t._v("#")]),t._v(" 7. 设计卡尔曼滤波器")]),n("p",[n("img",{attrs:{src:s(51),alt:""}})]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("# Write a function 'kalman_filter' that implements a multi-")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# dimensional Kalman Filter for the example given")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("########################################")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# Implement the filter function below")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("kalman_filter")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" P"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" n "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("range")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token builtin"}},[t._v("len")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("measurements"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{attrs:{class:"token comment"}},[t._v("# measurement update")]),t._v("\n        Z "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("measurements"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("n"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# 测量值")]),t._v("\n        y "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" Z "),n("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("H "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" x"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# 新的测量值矩阵")]),t._v("\n        S "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" H "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" P "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" H"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transpose"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" R "),n("span",{attrs:{class:"token comment"}},[t._v("#用于计算K，卡尔曼增益的分母")]),t._v("\n        K "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("  P "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" H"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transpose"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" S"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inverse"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("#卡尔曼增益")]),t._v("\n        x "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" x "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" K "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" y"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# 新的估计值")]),t._v("\n        P "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("I "),n("span",{attrs:{class:"token operator"}},[t._v("-")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("K "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" H"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" P "),n("span",{attrs:{class:"token comment"}},[t._v("# 新的估计误差")]),t._v("\n        \n        "),n("span",{attrs:{class:"token comment"}},[t._v("# prediction")]),t._v("\n        x "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("F"),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v("x"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" u "),n("span",{attrs:{class:"token comment"}},[t._v("# ")]),t._v("\n        P "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" F "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" P "),n("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" F"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("transpose"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n        \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" x"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("P\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("############################################")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("### use the code below to test your filter!")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("############################################")]),t._v("\n\nmeasurements "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("3")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nx "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# initial state (location and velocity)")]),t._v("\nP "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1000")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1000")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# initial uncertainty")]),t._v("\nu "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# external motion")]),t._v("\nF "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# next state function")]),t._v("\nH "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# measurement function")]),t._v("\nR "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# measurement uncertainty")]),t._v("\nI "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" matrix"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token comment"}},[t._v("# identity matrix")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("print")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("kalman_filter"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" P"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# output should be:")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# x: [[3.9996664447958645], [0.9999998335552873]]")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("# P: [[2.3318904241194827, 0.9991676099921091], [0.9991676099921067, 0.49950058263974184]]")]),t._v("\n\n")])]),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[t._v("扩展阅读")]),n("ol",[n("li",[n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/%E5%8D%A1%E5%B0%94%E6%9B%BC%E6%BB%A4%E6%B3%A2",target:"_blank",rel:"noopener noreferrer"}},[t._v("卡尔曼滤波")])]),n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/Jessica-jie/p/6893473.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("kalman滤波（一）---对各参数的理解")])]),n("li",[n("a",{attrs:{href:"http://www.ilectureonline.com/lectures/subject/SPECIAL%20TOPICS/26/190",target:"_blank",rel:"noopener noreferrer"}},[t._v("Lectures in The Kalman Filter")])])])])])}],o=s(0),r=Object(o.a)({},function(){this.$createElement;this._self._c;return this._m(0)},n,!1,null,null,null);a.default=r.exports},51:function(t,a,s){t.exports=s.p+"assets/img/15399619340700.f982be2b.jpg"}}]);