(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{246:function(t,s,a){t.exports=a.p+"assets/img/15221671430297.5af930df.jpg"},247:function(t,s,a){t.exports=a.p+"assets/img/15221665702654.b7a052ce.jpg"},248:function(t,s,a){t.exports=a.p+"assets/img/15219725805911.6deee9e3.jpg"},249:function(t,s,a){t.exports=a.p+"assets/img/15219724755519.27727e6d.jpg"},250:function(t,s,a){t.exports=a.p+"assets/img/15219723200489.5e4f2f72.jpg"},251:function(t,s,a){t.exports=a.p+"assets/img/15219723000936.97e3b3f7.jpg"},252:function(t,s,a){t.exports=a.p+"assets/img/15219722753416.f749bb98.jpg"},253:function(t,s,a){t.exports=a.p+"assets/img/15221660606569.762befa1.jpg"},254:function(t,s,a){t.exports=a.p+"assets/img/15221660448325.de4a4f11.jpg"},255:function(t,s,a){t.exports=a.p+"assets/img/15221659953306.8d997a45.jpg"},256:function(t,s,a){t.exports=a.p+"assets/img/15219564395258.367a79b4.jpg"},257:function(t,s,a){t.exports=a.p+"assets/img/15219560942995.6610aca2.jpg"},258:function(t,s,a){t.exports=a.p+"assets/img/15219553904482.ca2ed02d.jpg"},259:function(t,s,a){t.exports=a.p+"assets/img/15219527815258.088def04.jpg"},313:function(t,s,a){"use strict";a.r(s);var n=[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"content"},[n("p",[t._v("构建一个分类器需要经过如下几个步骤：")]),n("ol",[n("li",[t._v("加载并可视化数据")]),n("li",[t._v("图像预处理")]),n("li",[t._v("特性提取")]),n("li",[t._v("图像分类并查看错误的情况")])]),n("h2",{attrs:{id:"_1-加载并可视化数据"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-加载并可视化数据","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 加载并可视化数据")]),n("p",[t._v("为了对图像集进行解析和处理，第一步当然是要了解我们的目标，首先获取一个感性的认识，然后分析其特点")]),n("p",[t._v("我们首先从图像集里面过滤出三种颜色的信号灯，然后各取一张进行显示：")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("red_images "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("img "),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" img "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" IMAGE_LIST "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" img"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token string"}},[t._v("'red'")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nyellow_images "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("img "),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" img "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" IMAGE_LIST "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" img"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token string"}},[t._v("'yellow'")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ngreen_images "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("img "),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" img "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" IMAGE_LIST "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" img"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token string"}},[t._v("'green'")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n\nf"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplots"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("3")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("figsize"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("15")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("5")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("red_images"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("yellow_images"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("green_images"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("red_images"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("yellow_images"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("green_images"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),n("p",[n("img",{attrs:{src:a(259),alt:""}})]),n("h2",{attrs:{id:"_2-图像预处理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-图像预处理","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 图像预处理")]),n("p",[t._v("通过观察，可以发现几点关键信息：[^1]")]),n("ol",[n("li",[t._v("图片尺寸不一致")]),n("li",[t._v("图片光照条件不一致")])]),n("p",[t._v("为此我们需要对图像进行预处理：")]),n("ol",[n("li",[t._v("标准化")]),n("li",[t._v("one-hot 编码")])]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("#标准化")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("standardize_input")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" \n    standard_im "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    standard_im "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cv"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Resize"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("standard_im"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("32")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("32")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" standard_im\n")])]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("#one-hot 编码")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("one_hot_encode")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("label"),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token string"}},[t._v("'red'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        one_hot_encoded "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("elif")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("label"),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token string"}},[t._v("'yellow'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        one_hot_encoded "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("elif")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("label"),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token string"}},[t._v("'green'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        one_hot_encoded "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("    \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" one_hot_encoded\n")])]),n("p",[t._v("随后将图像集传入将所有图像进行标准化")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("standardize")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("image_list"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    standard_list "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" item "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" image_list"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        image "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" item"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("#标准化一幅图像")]),t._v("\n        standardized_im "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" standardize_input"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n        "),n("span",{attrs:{class:"token comment"}},[t._v("# 编码")]),t._v("\n        one_hot_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" one_hot_encode"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("    \n\n      standard_list"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("standardized_im"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" one_hot_label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" standard_list\n\n\nSTANDARDIZED_LIST "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" standardize"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IMAGE_LIST"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),n("p",[t._v("将"),n("code",[t._v("STANDARDIZED_LIST")]),t._v("中的结果选择其一打印出来")]),n("p",[n("img",{attrs:{src:a(258),alt:""}})]),n("h2",{attrs:{id:"_3-特性提取"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-特性提取","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 特性提取")]),n("p",[t._v("抽取特征")]),n("ol",[n("li",[t._v("亮度特征")]),n("li",[t._v("颜色特征")]),n("li",[t._v("....")])]),n("h3",{attrs:{id:"_1-亮度特征"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-亮度特征","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 亮度特征")]),n("p",[n("img",{attrs:{src:a(257),alt:""}})]),n("p",[t._v("首先我们将图像转换为 hsv 颜色空间")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("image_num "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),t._v("\ntest_im "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" STANDARDIZED_LIST"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("image_num"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ntest_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" STANDARDIZED_LIST"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("image_num"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("# Convert to HSV")]),t._v("\nhsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cvtColor"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_im"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("COLOR_RGB2HSV"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("# Print image label")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("print")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'Label [red, yellow, green]: '")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("str")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("# HSV channels")]),t._v("\nh "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\ns "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nf"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ax4"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplots"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("4")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" figsize"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("20")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("10")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'Standardized image'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_im"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'H channel'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("h"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmap"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token string"}},[t._v("'gray'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'S channel'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("s"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmap"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token string"}},[t._v("'gray'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax4"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'V channel'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nax4"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("v"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cmap"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token string"}},[t._v("'gray'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])]),n("p",[n("img",{attrs:{src:a(256),alt:""}}),t._v("\n由此可以看到，value 最能作为图像的特征，但是首先我们需要对图像进行预处理，这里的预处理指的是，我们需要对图像进行一些裁剪，保证信号灯部分占据主体。随后，将图像分割为上中下三部分，分别求对应部分像素value值的和，确定最亮的部分位于图像上中下哪个部分，以此作为信号灯判断的依据。")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("show_img_bright")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("masked"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    fig"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax4"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplots"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("4")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("figsize"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("10")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("10")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cmap"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token string"}},[t._v("'gray'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cmap"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token string"}},[t._v("'gray'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax4"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("masked"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cmap"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token string"}},[t._v("'gray'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("apply_bright_mask")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    masked_hsv_image "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    masked_hsv_image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mask "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" masked_hsv_image\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("apply_resize")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    v "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("5")]),t._v("\n    h "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("10")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("v"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("v"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("h"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v("h"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("calculate_brightness")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv_img"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    \n    height  "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" hsv_img"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    width "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" hsv_img"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    \n    block_height "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" height"),n("span",{attrs:{class:"token operator"}},[t._v("//")]),n("span",{attrs:{class:"token number"}},[t._v("3")]),t._v("\n    \n    top_sum "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token builtin"}},[t._v("sum")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv_img"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("block_height"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    mid_sum "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token builtin"}},[t._v("sum")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv_img"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("block_height"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("block_height"),n("span",{attrs:{class:"token operator"}},[t._v("*")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    bot_sum "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token builtin"}},[t._v("sum")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv_img"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("block_height"),n("span",{attrs:{class:"token operator"}},[t._v("*")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("block_height"),n("span",{attrs:{class:"token operator"}},[t._v("*")]),n("span",{attrs:{class:"token number"}},[t._v("3")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("top_sum"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("mid_sum"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("bot_sum"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    \n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("create_feature_brightness")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    hsv_img "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cvtColor"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("COLOR_RGB2HSV"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    lower_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("210")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    upper_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("255")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    mask"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inRange"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv_img"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lower_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("upper_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    masked_hsv_image "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" apply_bright_mask"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    resized_masked_img "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" apply_resize"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("masked_hsv_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("#show_img_bright(rgb_image,hsv_img,mask,resized_masked_img)")]),t._v("\n    feature "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" calculate_brightness"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resized_masked_img"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    "),n("span",{attrs:{class:"token comment"}},[t._v("#print(feature)")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" feature\n\n")])]),n("p",[n("img",{attrs:{src:a(255),alt:""}}),n("img",{attrs:{src:a(254),alt:""}})]),n("p",[n("img",{attrs:{src:a(253),alt:""}})]),n("p",[t._v("至此，我们得到了图像的亮度特征。")]),n("p",[t._v("但是作为交通灯，显然有亮度是不行的，因此我们再加入一个颜色特征")]),n("h3",{attrs:{id:"_2-颜色特征"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-颜色特征","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 颜色特征")]),n("p",[t._v("既然是信号灯，颜色自然是一个明显的特征，这里的思路是，首先转换为 hsv颜色空间，然后基于不同颜色对图像做 mask，将三种颜色对应的部分扣出来，分别计算其像素的和，最大的就是对应颜色")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("show_img")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("masked"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    fig"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ax4"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplots"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("4")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("figsize"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("20")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("20")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax1"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("cmap"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token string"}},[t._v("'gray'")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax3"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    ax4"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("masked"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    \n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("apply_mask")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    masked_hsv_image "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("copy"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    masked_hsv_image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mask "),n("span",{attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" masked_hsv_image\n\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("get_sum_red")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cvtColor"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("COLOR_RGB2HSV"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    lower_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("120")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("50")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("120")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    upper_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("180")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("255")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("255")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    mask"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inRange"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lower_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("upper_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    masked_hsv_image"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("apply_mask"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    total "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token builtin"}},[t._v("sum")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("masked_hsv_image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("#show_img(rgb_image,hsv,mask,masked_hsv_image)")]),t._v("\n    \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" total\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("get_sum_yellow")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cvtColor"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("COLOR_RGB2HSV"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    lower_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("10")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("50")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("120")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    upper_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("70")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("255")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("255")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    mask"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inRange"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lower_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("upper_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    masked_hsv_image"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("apply_mask"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    total "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token builtin"}},[t._v("sum")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("masked_hsv_image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("#show_img(rgb_image,hsv,mask,masked_hsv_image)")]),t._v("\n    \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" total\n\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("get_sum_green")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cvtColor"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("COLOR_RGB2HSV"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    lower_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("70")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("50")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("120")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" \n    upper_hsv "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("array"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("100")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("255")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("255")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    mask"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("cv2"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("inRange"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("lower_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("upper_hsv"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    masked_hsv_image"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("apply_mask"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("mask"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    total "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" np"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{attrs:{class:"token builtin"}},[t._v("sum")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("masked_hsv_image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),n("span",{attrs:{class:"token comment"}},[t._v("#show_img(rgb_image,hsv,mask,masked_hsv_image)")]),t._v("\n    \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" total\n\n\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("# (Optional) Add more image analysis and create more features")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("create_feature_color")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    red_total "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_sum_red"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    yellow_total "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_sum_yellow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    green_total "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_sum_green"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    feature"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("red_total"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("yellow_total"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("green_total"),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    \n")])]),n("p",[t._v("查看一下利用hsv 三个分量阈值过滤的效果\n"),n("img",{attrs:{src:a(252),alt:""}}),n("img",{attrs:{src:a(251),alt:""}}),n("img",{attrs:{src:a(250),alt:""}})]),n("p",[t._v("如果是用黄色过滤\n"),n("img",{attrs:{src:a(249),alt:""}}),t._v("\n用绿色过滤\n"),n("img",{attrs:{src:a(248),alt:""}})]),n("h2",{attrs:{id:"_4-图像分类并查看错误的情况"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-图像分类并查看错误的情况","aria-hidden":"true"}},[t._v("#")]),t._v(" 4. 图像分类并查看错误的情况")]),n("h3",{attrs:{id:"_1-应用特征进行估计"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-应用特征进行估计","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. 应用特征进行估计")]),n("p",[t._v("这里要注意的是如何运用多个特征进行估计。")]),n("blockquote",[n("p",[t._v('Fully-connected layer\nA fully-connected layer\'s job is to connect the input it sees to a desired form of output. As an example, say we are sorting images into two classes: day and night, you could give a fully-connected layer a set of feature maps and tell it to use a combination of these features (multiplying them, adding them, combining them, etc.) to output a prediction: whether a given image is likely taken during the "day" or "night." This output prediction is sometimes called the output layer.')])]),n("p",[n("img",{attrs:{src:a(247),alt:""}})]),n("p",[t._v("我们可以认为我们已经使用了两种不同的方法（convolutional layer）得到了两个特征，现在需要再 fully connected layer 将不同的特征进行组合。")]),n("p",[n("strong",[t._v("注意")]),t._v("：特征指的是特征提取的原始结果，并非基于其得出的 one-hot 编码。")]),n("p",[t._v("在这个项目里，我采取的是将两种特征（颜色和亮度）进行求和，然后使用合成后的特征进行预测，得到 one-hot 编码")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("predict")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("feature"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("and")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("elif")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("and")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("elif")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("and")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v(">")]),t._v(" feature"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("    \n        predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" predicted_label\n        \n\n    \n"),n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("estimate_label")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n   \n    "),n("span",{attrs:{class:"token comment"}},[t._v("#颜色特征 ")]),t._v("\n    color_feature "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" create_feature_color"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n    "),n("span",{attrs:{class:"token comment"}},[t._v("#亮度特征")]),t._v("\n    bright_feature "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" create_feature_brightness"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("rgb_image"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n    "),n("span",{attrs:{class:"token comment"}},[t._v('#print(color_feature," ",bright_feature)')]),t._v("\n    \n    "),n("span",{attrs:{class:"token comment"}},[t._v("#求和特征")]),t._v("\n    feature "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),t._v("i"),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("j "),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" i"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("j "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("zip")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("color_feature"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("bright_feature"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    \n    predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" predict"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("feature"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" predicted_label\n")])]),n("h3",{attrs:{id:"_2-图像分类并计算失误率"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-图像分类并计算失误率","aria-hidden":"true"}},[t._v("#")]),t._v(" 2. 图像分类并计算失误率")]),n("p",[t._v("使用模型进行分类并收集错误的结果用于评估")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("get_misclassified_images")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("test_images"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{attrs:{class:"token string"}},[t._v('"对图像集进行分类并获取被错误分类的图像"')]),t._v("\n    misclassified_images_labels "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" image "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" test_images"),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        im "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        true_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" image"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n        predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" estimate_label"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("im"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        \n        "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("predicted_label "),n("span",{attrs:{class:"token operator"}},[t._v("!=")]),t._v(" true_label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n            misclassified_images_labels"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("append"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("im"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" predicted_label"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" true_label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n            \n    "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" misclassified_images_labels\n    \n")])]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token comment"}},[t._v("#原始图像集")]),t._v("\nTEST_IMAGE_LIST "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" helpers"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("load_dataset"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("IMAGE_DIR_TEST"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("#标准化尺寸图像集")]),t._v("\nSTANDARDIZED_TEST_LIST "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" standardize"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("TEST_IMAGE_LIST"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("#错误分类的图像集")]),t._v("\nMISCLASSIFIED "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_misclassified_images"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STANDARDIZED_TEST_LIST"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n\ntotal "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("len")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("STANDARDIZED_TEST_LIST"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nnum_correct "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" total "),n("span",{attrs:{class:"token operator"}},[t._v("-")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("len")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MISCLASSIFIED"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\naccuracy "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" num_correct"),n("span",{attrs:{class:"token operator"}},[t._v("/")]),t._v("total\n\n"),n("span",{attrs:{class:"token keyword"}},[t._v("print")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v("'Accuracy: '")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("str")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("accuracy"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("print")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token string"}},[t._v('"Number of misclassified images = "')]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("str")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token builtin"}},[t._v("len")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MISCLASSIFIED"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{attrs:{class:"token operator"}},[t._v("+")]),n("span",{attrs:{class:"token string"}},[t._v("' out of '")]),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("str")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("total"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),n("p",[t._v("结果如下：")]),n("blockquote",[n("p",[t._v("Accuracy: 0.9831649831649831\nNumber of misclassified images = 5 out of 297")])]),n("p",[t._v("使用两个特征的分类结果，可能优于一个特征，但也可能因为不当的组合产生劣化的效果。[^2]")]),n("h3",{attrs:{id:"_3-查看错误分类的图像"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看错误分类的图像","aria-hidden":"true"}},[t._v("#")]),t._v(" 3. 查看错误分类的图像")]),n("pre",{pre:!0,attrs:{class:"language-python"}},[n("code",[n("span",{attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),n("span",{attrs:{class:"token function"}},[t._v("get_label_string")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" label"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v('"red"')]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("elif")]),t._v(" label"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v('"yellow"')]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("elif")]),t._v(" label"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{attrs:{class:"token operator"}},[t._v("==")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v('"green"')]),t._v("\n    "),n("span",{attrs:{class:"token keyword"}},[t._v("else")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n        "),n("span",{attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{attrs:{class:"token string"}},[t._v('"miss"')]),t._v("\n        \n\nimg_num "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("len")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MISCLASSIFIED"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ncols "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{attrs:{class:"token number"}},[t._v("4")]),t._v("\nrows "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" img_num"),n("span",{attrs:{class:"token operator"}},[t._v("%")]),t._v("cols\nfig"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" axes "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplots"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nrows"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("rows"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ncols"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("cols"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("figsize"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("15")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("10")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("#绘制子图， subplots 返回的axes 是一个 nrows*ncols 的矩阵")]),t._v("\n\nfig"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" axes "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" plt"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("subplots"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nrows"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("img_num"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ncols"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("figsize"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token number"}},[t._v("20")]),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),n("span",{attrs:{class:"token number"}},[t._v("50")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),n("span",{attrs:{class:"token comment"}},[t._v("#给每一个子轴赋值")]),t._v("\n"),n("span",{attrs:{class:"token comment"}},[t._v("#如果 axes 不是向量而是矩阵，则必须迭代axes.flat)")]),t._v("\n"),n("span",{attrs:{class:"token keyword"}},[t._v("for")]),t._v(" data"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("axe "),n("span",{attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),n("span",{attrs:{class:"token builtin"}},[t._v("zip")]),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MISCLASSIFIED"),n("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("axes"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("flat"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    img"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("data"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("0")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    label"),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v("data"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("1")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    true_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" data"),n("span",{attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{attrs:{class:"token number"}},[t._v("2")]),n("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    axe"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("imshow"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("img"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    predict_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_label_string"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    true_label "),n("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" get_label_string"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("true_label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \n    axe"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("set_title"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("predict_label"),n("span",{attrs:{class:"token operator"}},[t._v("+")]),n("span",{attrs:{class:"token string"}},[t._v('" <---\x3e "')]),n("span",{attrs:{class:"token operator"}},[t._v("+")]),t._v("true_label"),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    \nplt"),n("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("show"),n("span",{attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])]),n("p",[t._v("被错误分类的4幅图像如下[^3]")]),n("p",[n("img",{attrs:{src:a(246),alt:""}})]),n("hr"),n("div",{staticClass:"tip custom-block"},[n("p",{staticClass:"custom-block-title"},[t._v("扩展阅读")]),n("ol",[n("li",[n("a",{attrs:{href:"https://selfdrivingcars.mit.edu/",target:"_blank",rel:"noopener noreferrer"}},[t._v("MIT 无人车课程")])]),n("li",[n("a",{attrs:{href:"https://pymotw.com/2/glob/",target:"_blank",rel:"noopener noreferrer"}},[t._v("glob – Filename pattern matching")])]),n("li",[n("a",{attrs:{href:"https://matplotlib.org/api/pyplot_api.html#module-matplotlib.pyplot",target:"_blank",rel:"noopener noreferrer"}},[t._v("matplotlib.pyplot")])]),n("li",[n("a",{attrs:{href:"https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/",target:"_blank",rel:"noopener noreferrer"}},[t._v("one-hot label")])])])])])}],o=a(0),e=Object(o.a)({},function(){this.$createElement;this._self._c;return this._m(0)},n,!1,null,null,null);s.default=e.exports}}]);